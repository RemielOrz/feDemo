define(["OE"],function(a){console.log("module:Carousel");var b=window.Mobify=window.Mobify||{};return b.$=a.$,b.UI=b.UI||{classPrefix:"m-"},function(a,b){a.support=a.support||{},a.extend(a.support,{touch:"ontouchend"in b})}(b.$,document),b.UI.Utils=function(a){var b={},c=a.support;b.events=c.touch?{down:"touchstart",move:"touchmove",up:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup"},b.getCursorPosition=c.touch?function(a){return a=a.originalEvent||a,{x:a.touches[0].clientX,y:a.touches[0].clientY}}:function(a){return{x:a.clientX,y:a.clientY}},b.getProperty=function(a){for(var b=["Webkit","Moz","O","ms",""],c=document.createElement("div").style,d=0;d<b.length;++d)if(void 0!==c[b[d]+a])return b[d]+a},a.extend(c,{transform:!!b.getProperty("Transform"),transform3d:!!(window.WebKitCSSMatrix&&"m11"in new WebKitCSSMatrix)});var d=b.getProperty("Transform");b.translateX=c.transform3d?function(a,b){"number"==typeof b&&(b+="px"),a.style[d]="translate3d("+b+",0,0)"}:c.transform?function(a,b){"number"==typeof b&&(b+="px"),a.style[d]="translate("+b+",0)"}:function(a,b){"number"==typeof b&&(b+="px"),a.style.left=b};var e=(b.getProperty("Transition"),b.getProperty("TransitionDuration"));return b.setTransitions=function(a,b){a.style[e]=b?"":"0s"},b.requestAnimationFrame=function(){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)},b=function(){a.apply(window,arguments)};return b}(),b}(b.$),b.UI.Carousel=function(a,c){var d={dragRadius:10,moveRadius:20,classPrefix:void 0,classNames:{outer:"carousel",inner:"carousel-inner",item:"item",center:"center",touch:"has-touch",dragging:"dragging",active:"active"}},e=a.support,f=function(a,b){this.setOptions(b),this.initElements(a),this.initOffsets(),this.initAnimation(),this.bind()};return f.defaults=d,f.prototype.setOptions=function(c){var e=this.options||a.extend({},d,c);e.classNames=a.extend({},e.classNames,c.classNames||{}),e.classPrefix=e.classPrefix||b.UI.classPrefix,this.options=e},f.prototype.initElements=function(b){this._index=1,this.element=b,this.$element=a(b),this.$inner=this.$element.find("."+this._getClass("inner")),this.$items=this.$inner.children(),this.$start=this.$items.eq(0),this.$sec=this.$items.eq(1),this.$current=this.$items.eq(this._index),this._length=this.$items.length,this._alignment=this.$element.hasClass(this._getClass("center"))?.5:0},f.prototype.initOffsets=function(){this._offset=0,this._offsetDrag=0},f.prototype.initAnimation=function(){this.animating=!1,this.dragging=!1,this._needsUpdate=!1,this._enableAnimation()},f.prototype._getClass=function(a){return this.options.classPrefix+this.options.classNames[a]},f.prototype._enableAnimation=function(){this.animating||(c.setTransitions(this.$inner[0],!0),this.$inner.removeClass(this._getClass("dragging")),this.animating=!0)},f.prototype._disableAnimation=function(){this.animating&&(c.setTransitions(this.$inner[0],!1),this.$inner.addClass(this._getClass("dragging")),this.animating=!1)},f.prototype.update=function(){if(!this._needsUpdate){var a=this;this._needsUpdate=!0,c.requestAnimationFrame(function(){a._update()})}},f.prototype._update=function(){if(this._needsUpdate){var a=Math.round(this._offset+this._offsetDrag);c.translateX(this.$inner[0],a),this._needsUpdate=!1}},f.prototype.bind=function(){function b(a){e.touch||a.preventDefault(),m=!0,n=!1,h=c.getCursorPosition(a),i=0,j=0,k=!1,p._disableAnimation(),u=1==p._index,v=p._index==p._length}function d(a){if(m&&!n){var b=c.getCursorPosition(a);i=h.x-b.x,j=h.y-b.y,k||l(i)>l(j)&&l(i)>o?(k=!0,a.preventDefault(),u&&0>i?i=i*-t/(i-t):v&&i>0&&(i=i*t/(i+t)),p._offsetDrag=-i,p.update()):l(j)>l(i)&&l(j)>o&&(n=!0)}}function f(){m&&(m=!1,p._enableAnimation(),!n&&l(i)>s.moveRadius?i>0?p.next():p.prev():(p._offsetDrag=0,p.update()))}function g(a){k&&a.preventDefault()}var h,i,j,k,l=Math.abs,m=!1,n=!1,o=this.options.dragRadius,p=this,q=this.$element,r=this.$inner,s=this.options,t=this.$element.width(),u=!1,v=!1;r.on(c.events.down+".carousel",b).on(c.events.move+".carousel",d).on(c.events.up+".carousel",f).on("click.carousel",g).on("mouseout.carousel",f),q.on("click","[data-slide]",function(b){b.preventDefault();var c=a(this).attr("data-slide"),d=parseInt(c,10);isNaN(d)?p[c]():p.move(d)}),q.on("afterSlide",function(a,b,c){p.$items.eq(b-1).removeClass(p._getClass("active")),p.$items.eq(c-1).addClass(p._getClass("active")),p.$element.find("[data-slide='"+b+"']").removeClass(p._getClass("active")),p.$element.find("[data-slide='"+c+"']").addClass(p._getClass("active"))}),q.trigger("beforeSlide",[1,1]),q.trigger("afterSlide",[1,1]),p.update()},f.prototype.unbind=function(){this.$inner.off()},f.prototype.destroy=function(){this.unbind(),this.$element.trigger("destroy"),this.$element.remove(),this.$element=null,this.$inner=null,this.$start=null,this.$current=null},f.prototype.move=function(a,b){var c=this.$element,d=(this.$inner,this.$items),e=this.$start,f=this.$current,g=this._length,h=this._index;b=b||{},1>a?a=1:a>this._length&&(a=g),a==this._index,c.trigger("beforeSlide",[h,a]),this.$current=f=d.eq(a-1);var i=f.prop("offsetLeft")+f.prop("clientWidth")*this._alignment,j=e.prop("offsetLeft")+e.prop("clientWidth")*this._alignment,k=-(i-j);this._offset=k,this._offsetDrag=0,this._index=a,this.update(),c.trigger("afterSlide",[h,a])},f.prototype.next=function(){this.move(this._index+1)},f.prototype.prev=function(){this.move(this._index-1)},f}(b.$,b.UI.Utils),function(a){a.fn.carousel=function(c,d){var e=a.extend({},a.fn.carousel.defaults);return"object"==typeof c&&(e=a(e,c),d=null,c=null),this.each(function(){var f=(a(this),this._carousel);f||(f=new b.UI.Carousel(this,e)),c&&(f[c](d),"destroy"===c&&(f=null)),this._carousel=f}),this},a.fn.carousel.defaults={}}(a.$),a.$});