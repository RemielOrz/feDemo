define(["OE","ITouchMove"],function(a){function b(a){this.options=c.extend({},this.defaults,a),this.events={},this.init()}console.log("module:AsideWindow");var c=a.$,d=a.utils;return b.prototype={defaults:{"class":"",dir:"left",setContent:function(){console.log("setContent")},onSetContentEnd:function(){console.log("onSetContentEnd")},$triggerEl:null},init:function(){this.isActive=0,this.setDir(),this.createElement(),this.bindTargetEvt()},createElement:function(){var a=c(".ui-aside-win");return a.length?(this.$el=a,this.$mask=c(".ui-aside-win__mask"),this.$inner=c(".ui-aside-win__inner",a),void(this.$icon=c(".ui-aside-win__icon",a))):(this.$mask=c("<div></div>").addClass("u-mask").addClass("ui-aside-win__mask").hide(),this.$el=c("<div></div>").addClass("ui-aside-win").addClass(this.options.class).hide(),this.$icon=c('<i class="oefont-arrow-right ui-aside-win__icon"></i>').appendTo(this.$el),1==this.dir&&this.$el.addClass("_left"),-1==this.dir&&this.$el.addClass("_right"),11==this.dir&&this.$el.addClass("_top"),-11==this.dir&&this.$el.addClass("_bottom"),this.$el.add(this.$mask).appendTo("body"),void this.bindEvt())},bindEvt:function(){this.$el.iTouchMove({"class":"ui-aside-win__inner"}),this.$inner=c(".ui-aside-win__inner",this.$el),this.$el.on(d.events.down+".asideWindow",c.proxy(function(a){a.preventDefault()},this)).on("webkitTransitionEnd.asideWindow",c.proxy(function(){this.$el.hasClass("_active")||this.$el.hide()},this)),this.$mask.on(d.events.down+".asideWindow",function(a){a.stopPropagation(),a.preventDefault()}).on(d.events.move+".asideWindow",function(a){a.stopPropagation(),a.preventDefault()}).on(d.events.up+".asideWindow",c.proxy(function(a){a.stopPropagation(),a.preventDefault(),this.hide()},this)).on("webkitTransitionEnd.asideWindow",c.proxy(function(){this.$mask.hasClass("_active")||this.$mask.hide()},this)),this.$icon.on(d.events.up+".asideWindow",c.proxy(function(a){a.stopPropagation(),a.preventDefault(),this.hide()},this))},bindTargetEvt:function(){var a=this;this.options.$triggerEl&&this.options.$triggerEl.length&&this.options.$triggerEl.on("click.asideWindow",function(){a.initialized=a.__target==this,a.__target=this,a.show()})},setDir:function(){switch(this.options.dir){case"left":this.dir=1;break;case"right":this.dir=-1;break;case"top":this.dir=11;break;case"bottom":this.dir=-11;break;case 1:this.dir=1;break;case-1:this.dir=-1;break;case 11:this.dir=11;break;case-11:this.dir=-11;break;default:this.dir=-1}},setContent:function(){this.$inner.empty(),this.$inner.append(this.$icon),this.resetTouchMove(),"function"==typeof this.options.setContent&&this.options.setContent.call(this,this.$inner),"function"==typeof this.options.onSetContentEnd&&this.options.onSetContentEnd.call(this)},resetTouchMove:function(){var a=d.getProperty("Transform");this.$inner[0].style[a]=d.support.transform3d?"translate3d(0,0px,0)":"translate(0,0px)"},toggle:function(){var a=this.$el.add(this.$mask);this.isActive&&a.show(),this.isActive=!this.isActive,a.toggleClass("_active")},hide:function(){var a=this.$el.add(this.$mask);this.isActive=0,a.removeClass("_active")},show:function(){var a=c("body");this.isActive=1,this.$el.add(this.$mask).css({top:this.$el.height()+document.body.scrollTop>a.height()?a.height()-this.$el.height()+"px":document.body.scrollTop+"px",height:c(window).height()+"px"}).show().addClass("_active"),this.setContent()}},a.ui.AsideWindow=b,function(b){b.fn.asideWindow=function(c){return this.each(function(){var d=b(this),e=this._asideWindow;if(!e){var f=b.extend({$triggerEl:d},c);e=new a.ui.AsideWindow(f)}this._asideWindow=e}),this}}(a.$),b});